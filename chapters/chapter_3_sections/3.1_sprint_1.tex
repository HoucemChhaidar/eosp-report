\section{Sprint 1 - Authentication \& Roles Management}

\subsection{Sprint 1 Backlog}

The first sprint focuses on establishing the fundamental authentication infrastructure and user management capabilities for the Credix mobile payment application. This sprint implements a three-tier role-based access control system distinguishing between Super Admin, Admin, and End User, with automatic wallet creation upon user account setup. The following table presents the user stories prioritized for this sprint:

\begin{table}[!htbp]
  \centering
  \small
  \caption{Sprint 1 Backlog - Authentication \& Roles Management}
  \label{tab:sprint1_backlog}
  \begin{tabular}{|p{1.5cm}|p{3.5cm}|p{7cm}|p{2cm}|}
    \hline
    \textbf{ID} & \textbf{User Story} & \textbf{Description} & \textbf{Priority} \\ \hline
    US1 & Secure Authentication for All Users  
      & As a user (Super Admin, Admin, or End User), I want to authenticate using secure credentials so that I can access the appropriate dashboard safely and receive a JWT containing my role.  
      & Critical \\ \hline
    US2 & Manage Admin Accounts  
      & As a Super Admin, I want to create, update, delete, and view admin accounts to control who has administrative access to the system.  
      & Critical \\ \hline
    US3 & Manage End User Accounts  
      & As an Admin, I want to create, update, delete, and view end user accounts to control who has access to the payment system.  
      & High \\ \hline
    US4 & Manage Wallets  
      & As an Admin, I want to create, update, delete, and view end user wallets to manage the payment infrastructure.  
      & High \\ \hline
    US5 & Automatic Wallet Creation  
      & As an end user, I want my wallet to be created automatically upon account creation so that I can start using the payment system immediately.  
      & Medium \\ \hline
  \end{tabular}
\end{table}

\subsection{Use Case Diagram}

The following diagram illustrates the main use cases implemented during Sprint 1, showing the interactions between Super Admin and Admin actors with the system functionalities for user and wallet management.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.75\textwidth]{images/usecase_sprint1.png}
  \caption{Sprint 1 Use Case Diagram - Authentication \& Roles Management}
  \label{fig:sprint1_usecase_diagram}
\end{figure}

\subsection{Detailed Use Case Descriptions}

\clearpage

\subsubsection{UC1: Manage End Users}

\begin{longtable}{|p{4cm}|p{11cm}|}
        \caption{Description of Use Case « Manage End Users »}
  \label{tab:uc_manage_end_users} \\\hline
  \textbf{Title} & Manage End Users \\ \hline
  \textbf{Primary Actor} & Admin \\ \hline
  \textbf{Description} & This use case allows the Admin to:
    \begin{itemize}[nosep,leftmargin=*]
      \item create, update, or delete end user accounts;
      \item assign secure login credentials;
      \item enable or disable access to the payment system;
      \item view the list of users and their statuses.
    \end{itemize} \\ \hline
        \textbf{Preconditions} & The Admin is authenticated and has the rights to manage end user accounts. \\ \hline
    \textbf{Postconditions} & End user accounts are created, updated, or deleted; wallets are automatically created for new users. \\ \hline
    \textbf{Nominal Scenario} &
      \begin{enumerate}[nosep,leftmargin=*]
        \item The Admin accesses the user management interface.
        \item The system displays the list of existing end user accounts with their statuses.
        \item The Admin chooses to add, modify, or delete an account.
        \item The Admin enters or modifies account information (email, password).
        \item The system validates the data and records the modification.
        \item For a new user, the system automatically creates a wallet.
        \item The system confirms the update of user accounts.
      \end{enumerate} \\ \hline
    \textbf{Alternative Scenarios} &
      \begin{enumerate}[nosep,leftmargin=*]
        \item If a required field is empty, the system displays « Required Field » and blocks the action.
        \item If the email already exists, the system displays « User already exists ».
        \item If the Admin cancels the action, no modification is made.
      \end{enumerate} \\ \hline
    \textbf{Exception Scenarios} &
      \begin{enumerate}[nosep,leftmargin=*]
        \item In case of server error or database issue, the system displays « Internal error, please try again ».
      \end{enumerate} \\ \hline
\end{longtable}

\clearpage

\subsubsection{UC2: Manage Wallets}

\begin{longtable}{|p{4cm}|p{11cm}|}
      \caption{Description of Use Case « Manage Wallets »}
  \label{tab:uc_manage_wallets} \\
  \hline
  \textbf{Title} & Manage Wallets \\ \hline
  \textbf{Primary Actor} & Admin \\ \hline
  \textbf{Description} & This use case allows the Admin to create, view, update, and delete end user wallets. \\ \hline
  \textbf{Preconditions} & The Admin is authenticated and has the right to manage wallets. \\ \hline
\textbf{Postconditions} & The wallet is created, updated, deleted, or viewed, and its status is updated in the system. \\ \hline
  \textbf{Nominal Scenario} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item The Admin navigates to the wallet management interface.
      \item The Admin selects a user and chooses « Create », « Update », « Delete », or « View ».
      \item The Admin enters or modifies wallet details (initial balance, status).
      \item The system generates a unique tokenizedId for the new wallet.
      \item The system records the wallet and displays a success message.
    \end{enumerate} \\ \hline
  \textbf{Alternative Scenarios} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item If the user already has a wallet, the system displays « Wallet already exists ».
      \item If the Admin cancels the action, the wallet remains unchanged.
    \end{enumerate} \\ \hline
  \textbf{Exception Scenarios} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item In case of tokenizedId generation failure, the system displays « Wallet creation error ».
    \end{enumerate} \\ \hline
\end{longtable}

\clearpage

\subsubsection{UC3: Manage Admins}

\begin{longtable}{|p{4cm}|p{11cm}|}
      \caption{Description of Use Case « Manage Admins »}
  \label{tab:uc_manage_admins} \\
  \hline
  \textbf{Title} & Manage Admins \\ \hline
  \textbf{Primary Actor} & Super Admin \\ \hline
  \textbf{Description} & This use case allows the Super Admin to create, view, update, and delete admin accounts. \\ \hline
  \textbf{Preconditions} & The Super Admin is authenticated and has the right to manage admin accounts. \\ \hline
\textbf{Postconditions} & Admin accounts are created, updated, deleted, or viewed, and their status is updated in the system. \\ \hline
  \textbf{Nominal Scenario} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item The Super Admin navigates to the admin management interface.
      \item The system displays the list of existing admin accounts with their statuses.
      \item The Super Admin chooses « Create », « Update », « Delete », or « View ».
      \item The Super Admin enters or modifies admin account information (email, password).
      \item The system validates the data and records the modification.
      \item The system confirms the update of admin accounts.
    \end{enumerate} \\ \hline
  \textbf{Alternative Scenarios} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item If a required field is empty, the system displays « Required Field » and blocks the action.
      \item If the email already exists, the system displays « Admin already exists ».
      \item If the Super Admin cancels the action, no modification is made.
    \end{enumerate} \\ \hline
  \textbf{Exception Scenarios} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item In case of server error or database issue, the system displays « Internal error, please try again ».
    \end{enumerate} \\ \hline
\end{longtable}

\clearpage

\subsubsection{UC4: Authenticate}

\begin{longtable}{|p{4cm}|p{11cm}|}
      \caption{Description of Use Case « Authenticate »}
  \label{tab:uc_authenticate} \\
  \hline
  \textbf{Title} & Authenticate \\ \hline
  \textbf{Primary Actor} & Super Admin / Admin / End User \\ \hline
  \textbf{Description} & This use case allows users to authenticate into the system with their credentials to access appropriate functionalities based on their role. \\ \hline
  \textbf{Preconditions} & The user has valid credentials and the application is accessible. \\ \hline
\textbf{Postconditions} & The user is authenticated, receives a JWT token, and accesses the role-appropriate interface. \\ \hline
  \textbf{Nominal Scenario} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item The user opens the application and sees the login interface.
      \item The user enters their email and password.
      \item The system validates the credentials against the database.
      \item The system generates a JWT token containing role information.
      \item The user is redirected to the appropriate interface (Super Admin dashboard, Admin dashboard, or User wallet).
    \end{enumerate} \\ \hline
  \textbf{Alternative Scenarios} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item If the user chooses « Remember me », the token is securely stored locally.
      \item If it's the first login, the system may prompt for additional setup.
    \end{enumerate} \\ \hline
  \textbf{Exception Scenarios} &
    \begin{enumerate}[nosep,leftmargin=*]
      \item If the credentials are invalid, the system displays « Invalid email or password ».
      \item If the account is deactivated, the system displays « Account suspended, contact admin ».
      \item In case of network error, the system displays a connection error with retry option.
    \end{enumerate} \\ \hline
\end{longtable}

\subsection{Sequence Diagrams}

The following sequence diagrams illustrate the main interactions between different actors and system components for the key use cases of Sprint 1. Each diagram shows the detailed flow of operations for authentication and user management processes.

\subsubsection{Authentication Sequence Diagram}

This diagram illustrates the authentication process where a user (Super Admin, Admin, or End User) enters their credentials. The authentication interface transmits this information to the authentication controller, which validates credentials through the user model against the database. Upon successful validation, a JWT token is generated and returned; otherwise, an error message is displayed.

\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{images/seq_authentication.png}
\caption{Authentication Sequence Diagram}
\label{fig:seq_authentication}
\end{figure}

\subsubsection{User Creation Sequence Diagram}

This diagram shows the user creation process initiated by an Admin. The Admin submits user details through the interface, which are processed by the user controller. The system validates the data, checks for existing users, creates the new user account, and automatically triggers wallet creation for the new end user.

\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{images/seq_user_creation.png}
\caption{User Creation Sequence Diagram}
\label{fig:seq_user_creation}
\end{figure}

\subsection{Class Diagram (Sprint 1)}

The Sprint 1 class diagram, presented in Figure~\ref{fig:class_sprint1}, establishes the foundational business entities and their relationships:

\begin{itemize}[nosep,leftmargin=*]
\item \textbf{User}: Base entity with email, password, and timestamps (createdAt, updatedAt)
\item \textbf{Super Admin}: Inherits from User, manages Admin accounts
\item \textbf{Admin}: Inherits from User, manages End User accounts and Wallets
\item \textbf{End User}: Inherits from User, owns a Wallet
\item \textbf{Wallet}: Digital wallet with tokenizedId, balance, isActive status, timestamps, and transferAmount
\end{itemize}

The diagram shows inheritance relationships between User and its subclasses (Super Admin, Admin, End User). Super Admin manages Admins, Admin manages End Users and Wallets, and each End User owns exactly one Wallet, establishing a one-to-one relationship.

\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{images/class_sprint1.png}
\caption{Class Diagram - Sprint 1}
\label{fig:class_sprint1}
\end{figure}

\subsection{Realization (Sprint 1)}

In this section, we present the main interfaces developed during Sprint 1, focused on secure authentication and user management. The implementation covers both web application interfaces for Super Admins and Admins, and user interfaces for End Users. Each interface is illustrated with screenshots and accompanied by functionality descriptions.

\subsubsection{Authentication Interface}

The login interface provides secure access for all user types: Super Admin, Admin, and End User. The interface adapts based on user role, redirecting to appropriate dashboards upon successful authentication.

\begin{figure}[H]
  \centering
  \fbox{\parbox{\textwidth}{\centering\vspace{3cm}[Authentication Interface Screenshot Placeholder]\\\vspace{0.5cm}This will show the login form with email and password fields,\\role-based authentication, JWT token generation, and error handling.\vspace{3cm}}}
  \caption{Authentication Interface}
  \label{fig:sprint1_auth_interface}
\end{figure}

— \textbf{Key Features:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item Email and password input fields with validation
\item Role-based redirection (Super Admin dashboard, Admin dashboard, or User wallet)
\item JWT token generation and secure storage
\item Error handling for invalid credentials and network issues
\end{itemize}

— \textbf{Authentication Flow:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item User enters credentials and submits login form
\item System validates against user database with encrypted password comparison
\item On success: JWT token generated and user redirected to role-appropriate interface
\item On failure: Clear error message displayed with retry option
\end{itemize}

\subsubsection{Super Admin Dashboard}

The web-based Super Admin dashboard provides comprehensive admin account management capabilities.

\begin{figure}[H]
  \centering
  \fbox{\parbox{\textwidth}{\centering\vspace{3cm}[Super Admin Dashboard Screenshot Placeholder]\\\vspace{0.5cm}This will show admin management interface with create, update, delete, and view\\capabilities, system oversight, audit logging, and role-based access control.\vspace{3cm}}}
  \caption{Super Admin Dashboard}
  \label{fig:sprint1_superadmin_dashboard}
\end{figure}

— \textbf{Key Features:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item Admin management: Create, update, delete, and view admin accounts
\item System oversight and monitoring capabilities
\item Audit logging for all Super Admin actions
\item Secure role-based access control
\end{itemize}

— \textbf{Super Admin Workflow:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item Super Admin authenticates and accesses management dashboard
\item Creates admin accounts with secure credentials
\item Monitors admin activity and system health
\item Manages admin permissions and access levels
\end{itemize}

\subsubsection{Admin Dashboard}

The web-based Admin dashboard provides comprehensive user and wallet management capabilities.

\begin{figure}[H]
  \centering
  \fbox{\parbox{\textwidth}{\centering\vspace{3cm}[Admin Dashboard Screenshot Placeholder]\\\vspace{0.5cm}This will show user and wallet management interface with create, update, delete,\\and view capabilities, bulk operations, and audit logging.\vspace{3cm}}}
  \caption{Admin Dashboard}
  \label{fig:sprint1_admin_dashboard}
\end{figure}

— \textbf{Key Features:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item User management: Create, update, delete, and view end user accounts
\item Wallet management: Create, update, delete, and view wallets with balances and status
\item Bulk operations for efficient user onboarding
\item Audit logging for all administrative actions
\end{itemize}

— \textbf{Admin Workflow:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item Admin authenticates and accesses management dashboard
\item Creates end user accounts with secure credentials
\item System automatically generates wallets for new users
\item Admin can monitor user activity and wallet status
\end{itemize}

\subsubsection{End User Interface}

The web application provides end users with secure access to their wallet information and basic account management.

\begin{figure}[H]
  \centering
  \fbox{\parbox{\textwidth}{\centering\vspace{3cm}[End User Interface Screenshot Placeholder]\\\vspace{0.5cm}This will show the user wallet interface with balance display, account information,\\profile management, and responsive design for various devices.\vspace{3cm}}}
  \caption{End User Interface}
  \label{fig:sprint1_user_interface}
\end{figure}

— \textbf{Key Features:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item Secure login with credentials
\item Wallet balance display and account information
\item Profile management and security settings
\item Responsive design optimized for various devices
\end{itemize}

— \textbf{User Experience:}
\begin{itemize}[nosep,leftmargin=*,label=•]
\item Simple, intuitive login process
\item Immediate access to wallet information post-authentication
\item Clear navigation and user-friendly interface design
\item Secure session management with automatic logout
\end{itemize}
